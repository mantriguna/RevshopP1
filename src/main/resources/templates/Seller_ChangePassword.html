<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/Images/RevShop_1.png" type="image/png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
	<style>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}
	
	body {
		font-family: 'Roboto', sans-serif;
		background-color: #FE5000;
		color: #292929;
		display: flex;
		justify-content: center;
		align-items: center;
		height: 100vh;
		overflow: hidden;
		position: relative;
	}

	/* Bubbles container */
	.bubbles {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		overflow: hidden;
		z-index: 0; /* Behind the form */
	}

	.bubble {
		position: absolute;
		width: 20px;
		height: 20px;
		background-color: rgba(255, 255, 255, 0.3);
		border-radius: 50%;
		animation: moveBubble 10s infinite linear;
	}

	@keyframes moveBubble {
		0% {
			transform: translateY(100vh);
			opacity: 1;
		}
		100% {
			transform: translateY(-100vh);
			opacity: 0;
		}
	}

	.bubble:hover {
		animation: hoverMove 1.5s infinite ease-in-out;
	}

	@keyframes hoverMove {
		0%, 100% {
			transform: scale(1.2) translateX(0);
		}
		50% {
			transform: scale(1.2) translateX(30px);
		}
	}

	/* Main container styling */
	.container {
		display: flex;
		width: 90%;
		max-width: 800px;
		background-color: #ffffff;
		border-radius: 30px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
		z-index: 1; /* Above the bubbles */
		position: relative;
	}
	
	.left-panel {
		background-color: #292929;
		color: #ffffff;
		padding: 40px;
		width: 40%;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		text-align: center;
	}

	.right-panel {
		padding: 40px;
		width: 60%;
		display: flex;
		flex-direction: column;
		background-color: #F6F6F4;
	}

	.input-box {
		margin-bottom: 20px; /* Spacing between input boxes */
	}

	.input-box label {
		margin-bottom: 8px; /* Spacing between label and input */
		display: block;
	}

	.input-box input {
		width: 100%;
		padding: 12px; /* Padding for input fields */
		border: 1px solid #E4E4E4;
		border-radius: 5px;
		font-size: 16px;
		color: #292929;
		background-color: #fff;
		transition: border 0.3s ease;
		margin-bottom: 10px; /* Space between input field and button */
	}

	.input-box input:focus {
		border-color: #A369C5;
		outline: none;
	}

	.continue-btn {
		background-color:#FE5000;
		color: white;
		padding: 12px;
		border: none;
		border-radius: 5px;
		width: 100%;
		font-size: 16px;
		font-weight: bold;
		cursor: pointer;
		transition: background-color 0.3s ease;
	}

	.continue-btn:hover {
		background-color: #292929;
	}

	.login-link {
		text-align: center;
		margin-top: 30px;
	}

	.login-link a {
		color: #FE5000;
		text-decoration: none;
		font-weight: bold;
	}

	.requirements {
		font-size: 12px;
		color: #6B7280;
		margin-top: 10px;
	}

	.password-strength {
		margin-top: 5px;
		font-size: 12px;
	}

	.weak {
		color: #dc2626;
	}

	.medium {
		color: #f59e0b;
	}

	.strong {
		color: #22c55e;
	}
	</style>
    <style>
         * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #FE5000;
            color: #292929;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .container {
            overflow: hidden;
            display: flex;
            width: 90%;
            max-width: 800px;
            background-color: #ffffff;
            border-radius: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .left-panel {
            background-color: #292929;
            color: #ffffff;
            padding: 40px;
            width: 40%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .right-panel {
            border-radius: inherit;
            padding: 40px;
            width: 60%;
            display: flex;
            flex-direction: column;
            background-color: #F6F6F4;
        }

        .input-box {
            margin-bottom: 20px;
        }

        .input-box label {
            margin-bottom: 8px;
            display: block;
        }

        .input-box input {
            width: 100%;
            padding: 12px;
            border: 1px solid #E4E4E4;
            border-radius: 5px;
            font-size: 16px;
            color: #292929;
            background-color: #fff;
            transition: border 0.3s ease;
        }

        .input-box input:focus {
            border-color: #A369C5;
            outline: none;
        }

        .continue-btn {
            background-color:#FE5000;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 5px;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .continue-btn:hover { background-color: #292929; }

        .login-link { text-align: center; margin-top: 30px; }

        .login-link a { color: #FE5000; text-decoration: none; font-weight: bold; }

        .requirements {
            font-size: 12px;
            color: #6B7280;
            margin-top: 10px;
        }

        .password-strength { margin-top: 5px; font-size: 12px; }

        .weak { color: #dc2626; }
        .medium { color: #f59e0b; }
        .strong { color: #22c55e; }
        </style>
</head>
<body>

	<!-- Bubble animation -->
	<div class="bubbles" id="bubble-container"></div>
        <div class="container">
            <div class="left-panel">
                <h2><img src="../Images/RevShop_1.png" alt="Revshop Icon" style="width: 200px; height: 200px; margin-right: 8px; border-radius:10px; border: 30px;"><br><br>Change Password</h2>
                
            </div>
             <div class="right-panel">
	            <form id="reset-password-form" th:action="@{/Seller/changepassword}" th:method="post" onsubmit="return handlePasswordChange(event)">
				    <div id="verification-step" class="input-box">
				        <label for="verification-code">Enter the 6-digit verification code</label>
				        <input type="text" id="verification-code" name="verification-code" placeholder="Enter code" required maxlength="6">
				        <button type="button" class="continue-btn" onclick="verifyCode()">Verify Code</button>
				        <button type="button" class="continue-btn" style="margin-top: 10px;" id="resend-otp-btn" onclick="resendOTP()">Resend OTP</button>
				        <button type="button" class="continue-btn" style="margin-top: 10px;" onclick="goBack()">Back</button>
				    </div>
				
				    <div id="reset-step" class="input-box" style="display: none;">
				        <label for="new-password">New Password</label>
				        <input type="password" id="new-password" name="new-password" placeholder="Enter new password" required oninput="checkPasswordStrength()">
				        <div id="password-strength" class="password-strength"></div>
				        <div class="requirements">
				            <p>Your password should include:</p>
				            <ul>
				                <li>At least one lowercase letter</li>
				                <li>At least one uppercase letter</li>
				                <li>At least one number</li>
				                <li>At least one special character</li>
				                <li>Minimum 8 characters long</li>
				            </ul>
				        </div>
				        <label for="confirm-password">Confirm New Password</label>
				        <input type="password" id="confirm-password" name="confirm-password" placeholder="Re-enter new password" required>
				        <button type="submit" class="continue-btn">Reset Password</button>
				    </div>
				</form>
	        </div>
        </div>

	<script>
		// Generate bubbles
		function createBubble() {
			const bubble = document.createElement('div');
			bubble.classList.add('bubble');
			
			// Random size and position for each bubble
			const size = Math.random() * 60 + 20 + 'px';
			bubble.style.width = size;
			bubble.style.height = size;
			bubble.style.left = Math.random() * 100 + 'vw';
			bubble.style.animationDuration = Math.random() * 5 + 5 + 's';

			document.getElementById('bubble-container').appendChild(bubble);

			// Remove bubble after its animation ends
			setTimeout(() => {
				bubble.remove();
			}, 10000); // 10 seconds duration
		}

		// Create bubbles at intervals
		setInterval(createBubble, 200);
         // Step 1: Send verification code
         
         
         function resendOTP() {
		    // Alert the user that the OTP has been sent
		    alert("A new OTP has been sent to your registered email.");
		
		    // Redirect to the Seller change password page
		    window.location.href = "/Seller/changepassword"; // Adjust this URL as needed based on your application context
		}
        function verifyCode() {
            const enteredCode = document.getElementById('verification-code').value;
            const userType = new URLSearchParams(window.location.search).get('userType');

            fetch('/Seller/verifyotp', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    code: enteredCode,
                    userType: userType
                })
            })
            .then(response => {
                if (response.ok) {
                    document.getElementById('verification-step').style.display = 'none';
                    document.getElementById('reset-step').style.display = 'block';
                } else {
                    throw new Error('Invalid verification code');
                }
            })
            .catch(error => {
                alert(error.message);
            });
        }



        // Password strength checker
        function checkPasswordStrength() {
            const password = document.getElementById('new-password').value;
            let strength = 'weak';
            let color = '#dc2626';

            if (password.length >= 8) {
                const hasUpper = /[A-Z]/.test(password);
                const hasLower = /[a-z]/.test(password);
                const hasNumber = /\d/.test(password);
                const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);

                if (hasUpper && hasLower && hasNumber && hasSpecial) {
                    strength = 'strong';
                    color = '#22c55e'; // green
                } else if (hasUpper || hasLower || hasNumber || hasSpecial) {
                    strength = 'medium';
                    color = '#f59e0b'; // orange
                }
            }

            document.getElementById('password-strength').textContent = `Password strength: ${strength}`;
            document.getElementById('password-strength').style.color = color;
        }

        // Go back to the previous page
        function goBack() {
            window.history.back();
        }
          
        function handlePasswordChange(event) {
            event.preventDefault(); // Prevent the default form submission

            const formData = new FormData(event.target); // Collect form data

            fetch(event.target.action, {
                method: event.target.method,
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    alert("Password changed successfully! Redirecting to login page...");
                    window.location.href = "/Seller/login"; // Change this to your actual login page URL
                } else {
                    return response.text().then(text => {
                        alert(text); // Show the error message from the server
                    });
                }
            })
            .catch(error => {
                alert("An error occurred: " + error.message);
            });
        }

       
	</script>
</body>
</html>
